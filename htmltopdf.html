<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <title>HTML to PDF Converter | SRJ Tools</title>
    <meta name="description" content="Convert any HTML file into high-quality PDF online. Free, fast, secure — SRJ Tools."/>

    <link rel="stylesheet" href="style.css"/>
    <link rel="icon" href="tools.png"/>

    <!-- Analytics (unchanged) -->
    <script src="ga.js"></script>

    <!-- HTML to PDF (Client-side) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>

<canvas id="waveCanvas"></canvas>

<header>
    <div class="logo-container">
        <img src="./assets/cloud.png" class="logo-part cloud"/>
        <img src="./assets/gear-ring.png" class="logo-part gear"/>
        <img src="./assets/code-center.png" class="logo-part center"/>
    </div>

    <h1>HTML to PDF</h1>
    <p>Convert your HTML files into clean, printable PDFs</p>
</header>

<section class="converter-section">
    <div class="converter-box">

        <input type="file" id="htmlFile" accept=".html,.htm"/>

        <button id="convertBtn" class="convert-btn">
            Convert to PDF
        </button>

        <div class="progress-container">
            <div id="progressBar"></div>
        </div>

        <div id="successBox" class="success-box" style="display:none;">
            ✅ Conversion Successful!
            <br/>
            <button id="downloadBtn" class="download-btn">
                ⬇ Download PDF
            </button>
        </div>

        <button onclick="location.href='index.html'" class="back-btn">
            ← Back to Home
        </button>

    </div>
</section>

<footer>
    © 2025 SRJahir Tech | Powered by CloudAI
</footer>

<script src="animation.js"></script>

<script>
const htmlFile   = document.getElementById("htmlFile");
const convertBtn = document.getElementById("convertBtn");
const progressBar = document.getElementById("progressBar");
const successBox  = document.getElementById("successBox");
const downloadBtn = document.getElementById("downloadBtn");

let outputName = "output.pdf";

convertBtn.onclick = () => {
    const file = htmlFile.files[0];
    if (!file) {
        alert("Please select an HTML file first!");
        return;
    }

    outputName = file.name.replace(/\.[^/.]+$/, "") + ".pdf";
    progressBar.style.width = "0%";
    successBox.style.display = "none";

    // Smooth fake progress (UX same as before)
    const loading = setInterval(() => {
        let w = parseInt(progressBar.style.width) || 0;
        if (w < 90) progressBar.style.width = (w + 6) + "%";
    }, 200);

    const reader = new FileReader();

    reader.onload = () => {
        clearInterval(loading);
        progressBar.style.width = "100%";

        // Temporary container (not visible)
        const container = document.createElement("div");
        container.style.padding = "20px";
        container.innerHTML = reader.result;

        html2pdf()
            .from(container)
            .set({
                margin: 10,
                filename: outputName,
                html2canvas: {
                    scale: 2,
                    useCORS: true
                },
                jsPDF: {
                    unit: "mm",
                    format: "a4",
                    orientation: "portrait"
                }
            })
            .save()
            .then(() => {
                successBox.style.display = "block";
            })
            .catch(() => {
                alert("❌ Conversion failed. Try another file.");
            });
    };

    reader.readAsText(file);
};

// Download button (optional, PDF auto-downloads anyway)
downloadBtn.onclick = () => {};
</script>

</body>
</html>
