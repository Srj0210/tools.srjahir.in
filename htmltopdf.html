<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <title>HTML to PDF Converter | SRJ Tools</title>
    <meta name="description" content="Convert any HTML file into high-quality PDF online. Free, fast, secure — SRJ Tools."/>
    <link rel="stylesheet" href="style.css"/>
    <link rel="icon" href="tools.png"/>
</head>

<body>
<canvas id="waveCanvas"></canvas>

<header>
    <div class="logo-container">
        <img src="./assets/cloud.png" class="logo-part cloud"/>
        <img src="./assets/gear-ring.png" class="logo-part gear"/>
        <img src="./assets/code-center.png" class="logo-part center"/>
    </div>

    <h1>HTML to PDF</h1>
    <p>Convert your HTML files into clean, printable PDFs</p>
</header>

<section class="converter-section">
    <div class="converter-box">
        <input type="file" id="htmlFile" accept=".html,.htm"/>
        <button id="convertBtn" class="convert-btn">Convert to PDF</button>

        <div class="progress-container">
            <div id="progressBar"></div>
        </div>

        <div id="successBox" class="success-box" style="display:none;">
            ✅ Conversion Successful!
            <br/>
            <button id="downloadBtn" class="download-btn">⬇ Download PDF</button>
        </div>

        <button onclick="location.href='index.html'" class="back-btn">← Back to Home</button>
    </div>
</section>

<footer>
    © 2025 SRJahir Tech | Powered by CloudAI
</footer>

<script src="animation.js"></script>

<script>
const API = "https://api.srjahir.in";

const htmlFile = document.getElementById("htmlFile");
const convertBtn = document.getElementById("convertBtn");
const progressBar = document.getElementById("progressBar");
const successBox = document.getElementById("successBox");
const downloadBtn = document.getElementById("downloadBtn");

let finalBlob = null;
let outputName = "output.pdf";

convertBtn.onclick = async () => {
    const file = htmlFile.files[0];
    if (!file) return alert("Please select an HTML file first!");

    outputName = file.name.replace(/\.[^/.]+$/, "") + ".pdf";
    progressBar.style.width = "0%";
    successBox.style.display = "none";

    const form = new FormData();
    form.append("file", file);

    const loading = setInterval(() => {
        let w = parseInt(progressBar.style.width) || 0;
        if (w < 90) progressBar.style.width = (w + 8) + "%";
    }, 200);

    try {
        const res = await fetch(`${API}/html-to-pdf`, {
            method: "POST",
            body: form,
        });

        clearInterval(loading);
        progressBar.style.width = "100%";

        if (!res.ok) throw new Error("Failed");

        finalBlob = await res.blob();
        successBox.style.display = "block";

    } catch (e) {
        alert("❌ Conversion failed. Try another file.");
    }
};

downloadBtn.onclick = () => {
    if (!finalBlob) return;
    const url = URL.createObjectURL(finalBlob);
    const a = document.createElement("a");
    a.href = url;
    a.download = outputName;
    a.click();
    URL.revokeObjectURL(url);
};
</script>
</body>
</html>